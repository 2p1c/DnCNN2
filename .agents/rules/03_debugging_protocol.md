---
trigger: always_on
---

# Debugging & Refactoring Protocol

## 🕵️♂️ Root Cause Analysis First
当被要求修复 Bug 时，**严禁**直接给出修复后的代码。必须遵循以下步骤：

1. **复述错误**: 简要说明你认为是什么导致了错误。
2. **假设验证**: 列出 1-2 个可能的原因（例如：张量维度不匹配、梯度消失、数据加载器索引越界）。
3. **方案对比**: 提出修复方案，并解释为什么这个方案是最好的。
4. **实施修复**: 只有在以上步骤完成后，才输出代码。

## 🧹 Refactoring Rules
- **保持原有风格**: 重构时，不要随意更改原有的命名风格或目录结构，除非被明确要求。
- **不要删除注释**: 除非注释已经完全过时，否则不要在重构过程中静默删除代码中的重要注释。
- **原子化提交**: 如果修复涉及多个文件，请分步骤说明，不要一次性输出巨大的代码块。
